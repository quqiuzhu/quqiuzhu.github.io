webpackJsonp([4,8],{"0oqJ":function(t,e,i){"use strict";var r=i("woOf"),n=i.n(r),o=i("UgCr"),a=i("E4LH");e.a={name:"ProductEditor",props:{product:{type:Object,default:function(){return{title:"",description:"",price:128,orig_price:160,days:365}}},onAction:{type:Function,default:null}},data:function(){return{loading:!1,formRules:{title:[{required:!0,trigger:"blur",validator:a.e}],description:[{required:!0,trigger:"blur",validator:a.f}]}}},methods:{cancel:function(){this.$refs.form.resetFields(),this.onAction(!1)},submit:function(){var t=this;this.$refs.form.validate(function(e){if(e){t.loading=!0;var r=n()({},t.product);r.price=parseInt(100*r.price),r.orig_price=parseInt(100*r.orig_price);(r.id?i.i(o.c)(r.id,r):i.i(o.d)(r)).then(function(e){t.loading=!1,t.$message({message:"提交成功",type:"success"}),t.onAction(!0),t.$refs.form.resetFields()}).catch(function(){t.loading=!1})}})}}}},"1alW":function(t,e,i){var r=i("kM2E");r(r.S,"Number",{isInteger:i("AKgy")})},"6MxL":function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",[i("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[i("el-form",{attrs:{inline:!0}},[i("el-form-item",[i("el-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.add}})],1),t._v(" "),i("el-form-item",{staticStyle:{float:"right"}},[i("el-button",{on:{click:t.fetchProducts}},[i("i",{staticClass:"fa fa-refresh",attrs:{"aria-hidden":"true"}})])],1)],1)],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.items,"highlight-current-row":""}},[i("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t._v(" "),i("el-table-column",{attrs:{prop:"title",label:"标题",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"description",label:"描述","min-width":"160"}}),t._v(" "),i("el-table-column",{attrs:{prop:"price",label:"价格",width:"80"}}),t._v(" "),i("el-table-column",{attrs:{prop:"orig_price",label:"原价",width:"80"}}),t._v(" "),i("el-table-column",{attrs:{prop:"days",label:"时长(天)",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"small"},on:{click:function(i){t.edit(e.$index,e.row)}}},[t._v("编辑")])]}}])})],1),t._v(" "),i("el-col",{staticClass:"toolbar",attrs:{span:24}},[i("el-button",{attrs:{type:"primary"},on:{click:t.buyPackage}},[t._v("购买")]),t._v(" "),i("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":t.params.count,total:t.total,"current-page":t.page},on:{"current-change":t.pageChanged}})],1),t._v(" "),i("el-dialog",{attrs:{title:t.editeTitle,"close-on-click-modal":!1},model:{value:t.editerVisible,callback:function(e){t.editerVisible=e},expression:"editerVisible"}},[i("product-editor",{attrs:{onAction:t.onEdited,product:t.editingProduct}})],1)],1)},n=[],o={render:r,staticRenderFns:n};e.a=o},AKgy:function(t,e,i){var r=i("EqjI"),n=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&n(t)===t}},E4LH:function(t,e,i){"use strict";function r(t){return/^1[0-9]{10}$/.test(t)}function n(t,e,i){r(e)?i():i(new Error("请输入正确的手机号"))}function o(t,e,i){e.length<2?i(new Error("用户名至少2个字符")):i()}function a(t,e,i){e.length<6?i(new Error("密码不能小于6位")):i()}function l(t,e,i){e.length<2||e.length>16?i(new Error("请输入2-16个字")):i()}function c(t,e,i){e.length<8||e.length>255?i(new Error("请输入8-255个字")):i()}function s(t,e,i){e.length>0&&e.length<60?i():i(new Error("服务器地址为必填"))}e.b=n,e.a=o,e.c=a,e.e=l,e.f=c,e.d=s;var u=i("RRo+");i.n(u)},EgoN:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("0oqJ"),n=i("HYxH"),o=i("VU/8"),a=o(r.a,n.a,null,null,null);e.default=a.exports},HYxH:function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-form",{ref:"form",attrs:{model:t.product,"label-width":"80px",rules:t.formRules}},[i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{attrs:{placeholder:"标题(2-16个字)","auto-complete":"off"},model:{value:t.product.title,callback:function(e){t.product.title=e},expression:"product.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"描述",prop:"description"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入套餐描述(8-255个字)","auto-complete":"off"},model:{value:t.product.description,callback:function(e){t.product.description=e},expression:"product.description"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"套餐时长"}},[i("el-select",{attrs:{placeholder:"请选择套餐时长"},model:{value:t.product.days,callback:function(e){t.product.days=e},expression:"product.days"}},[i("el-option",{attrs:{label:"一年",value:"365"}}),t._v(" "),i("el-option",{attrs:{label:"半年",value:"180"}}),t._v(" "),i("el-option",{attrs:{label:"三个月",value:"90"}}),t._v(" "),i("el-option",{attrs:{label:"一个月",value:"31"}}),t._v(" "),i("el-option",{attrs:{label:"体验周",value:"5"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"价格"}},[i("el-col",{attrs:{span:10}},[i("el-input-number",{attrs:{"auto-complete":"off",min:.01,step:1,max:1e3},model:{value:t.product.price,callback:function(e){t.product.price=e},expression:"product.price"}})],1),t._v(" "),i("el-col",{attrs:{span:11}},[i("span",[t._v("原价 ")]),t._v(" "),i("el-input-number",{attrs:{"auto-complete":"off",min:1,step:10,max:1e3},model:{value:t.product.orig_price,callback:function(e){t.product.orig_price=e},expression:"product.orig_price"}})],1)],1),t._v(" "),i("el-form-item",[i("el-button",{nativeOn:{click:function(e){t.cancel(e)}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){t.submit(e)}}},[t._v("提交")])],1)],1)},n=[],o={render:r,staticRenderFns:n};e.a=o},"RRo+":function(t,e,i){t.exports={default:i("c45H"),__esModule:!0}},SKi1:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("xntx"),n=i("6MxL"),o=i("VU/8"),a=o(r.a,n.a,null,null,null);e.default=a.exports},UgCr:function(t,e,i){"use strict";function r(t){return i.i(l.a)({url:"/products",method:"get",params:t})}function n(t){return i.i(l.a)({url:"/products",method:"post",data:t})}function o(t,e){return i.i(l.a)({url:"/product/"+t,method:"put",data:e})}function a(t){return i.i(l.a)({url:"/product/"+t,method:"delete"})}e.a=r,e.d=n,e.c=o,e.b=a;var l=i("Vo7i")},c45H:function(t,e,i){i("1alW"),t.exports=i("FeBl").Number.isInteger},xntx:function(t,e,i){"use strict";var r=i("woOf"),n=i.n(r),o=i("EgoN"),a=i("UgCr"),l=i("yEme");e.a={components:{ProductEditor:o.default},data:function(){return{params:{start:0,count:10},items:[],total:0,page:1,loading:!1,editeTitle:"",editerVisible:!1,editingProduct:{}}},created:function(){this.fetchProducts()},methods:{fetchProducts:function(){var t=this;this.loading=!0,i.i(a.a)(this.params).then(function(e){t.items=e.list,t.total=e.total,t.loading=!1}).catch(function(){t.loading=!1})},pageChanged:function(t){this.params.start=(t-1)*this.params.count,this.fetchProducts()},add:function(){this.editeTitle="添加",this.editerVisible=!0,this.editingProduct=n()({},{title:"",description:"",price:128,orig_price:160,days:365})},edit:function(t,e){this.editeTitle="编辑",this.editerVisible=!0,this.editingProduct=n()({},e)},onEdited:function(t){this.editerVisible=!1,this.editingProduct.id||(this.page=1),t&&this.fetchProducts()},remove:function(t,e){var r=this,n="确认要删除「"+e.title+"」吗?";this.$confirm(n,"提示",{type:"warning"}).then(function(){r.loading=!0,i.i(a.b)(e.id).then(function(t){r.loading=!1,r.$message({message:"删除成功",type:"success"}),fetchProducts()}).catch(function(){r.loading=!1})})},buyPackage:function(){var t=this;i.i(l.a)("month","ali").then(function(e){t.loading=!1,WP.click(e),WP.err=function(t){this.$message({message:"支付失败",type:"warning"}),console.log(t)}}).catch(function(){t.loading=!1})}}}},yEme:function(t,e,i){"use strict";function r(t,e){return i.i(a.a)({url:"/counter/buy",method:"post",data:{package:t,channel:e}})}function n(t){return i.i(a.a)({url:"/counter/orders",method:"get",params:t})}function o(t,e){return i.i(a.a)({url:"/order/"+t,method:"put",data:e})}e.a=r,e.c=n,e.b=o;var a=i("Vo7i")}});
//# sourceMappingURL=4.184b4423ec32528d3219.js.map